"use strict";(self.webpackChunkintegration_development_docs=self.webpackChunkintegration_development_docs||[]).push([[639],{1295:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/wazuh-module-a46ab9d1f6301adb1868259fe373cbb0.png"},1454:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/module-maker-filled-out-049e5717f4503af2059ff1f5ea2e5cec.png"},1925:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>d,default:()=>c,frontMatter:()=>l,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"relay-module/create-module-type","title":"Creating a Module Type","description":"To create dashboard tiles, we first need to create a module type. A module type defines what Cisco XDR is able to use the relay module for. The below are different options that can be selected when creating a module type:","source":"@site/mdx-docs/relay-module/01-create-module-type.mdx","sourceDirName":"relay-module","slug":"/relay-module/create-module-type","permalink":"/xdr-integration-development-docs/docs/relay-module/create-module-type","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Creating a Relay Module","permalink":"/xdr-integration-development-docs/docs/relay-module/create-a-relay"},"next":{"title":"Using Auth in a Module","permalink":"/xdr-integration-development-docs/docs/relay-module/module-auth"}}');var i=n(4848),s=n(8453);const l={sidebar_position:1},d="Creating a Module Type",r={},a=[{value:"Module Maker",id:"module-maker",level:2},{value:"Upload Module Type to Cisco XDR",id:"upload-module-type-to-cisco-xdr",level:2},{value:"Check XDR Module",id:"check-xdr-module",level:2}];function h(e){const t={a:"a",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"creating-a-module-type",children:"Creating a Module Type"})}),"\n",(0,i.jsxs)(t.p,{children:["To create dashboard tiles, we first need to create a ",(0,i.jsx)(t.strong,{children:"module type"}),". A ",(0,i.jsx)(t.strong,{children:"module type"})," defines what Cisco XDR is able to use the relay module for. The below are different options that can be selected when creating a ",(0,i.jsx)(t.strong,{children:"module type"}),":"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"health"}),"\n",(0,i.jsx)(t.li,{children:"deliberate"}),"\n",(0,i.jsx)(t.li,{children:"refer"}),"\n",(0,i.jsx)(t.li,{children:"observe"}),"\n",(0,i.jsx)(t.li,{children:"respond (via an observable)"}),"\n",(0,i.jsx)(t.li,{children:"respond (via a trigger)"}),"\n",(0,i.jsx)(t.li,{children:"tiles"}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["Of the above options, the ",(0,i.jsx)(t.em,{children:"health"})," options needs to be selected when creating a module type. This is because Cisco XDR will need to check the health of the relay module before it can be used for any other options."]}),"\n",(0,i.jsx)(t.p,{children:"Depending on your integration, you may only want some of these options enabled for your relay module. For our example, we will use all of them, but we will only enable them as we start to build that functionality."}),"\n",(0,i.jsxs)(t.p,{children:["Additionaly, your service's logo, title, URL, and authorization schema will be defined in the ",(0,i.jsx)(t.strong,{children:"module type"}),". This is the URL that Cisco XDR will use to communicate with your relay module. The authorization schema is the method that Cisco XDR will use to authenticate with your relay module. The option we support for authentication include:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"authorization header"}),"\n",(0,i.jsx)(t.li,{children:"basic"}),"\n",(0,i.jsx)(t.li,{children:"bearer"}),"\n",(0,i.jsx)(t.li,{children:"configuration-token"}),"\n",(0,i.jsx)(t.li,{children:"none"}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["Lets create a module using the ",(0,i.jsx)(t.strong,{children:"Module Maker"})," we provide."]}),"\n",(0,i.jsx)(t.h2,{id:"module-maker",children:"Module Maker"}),"\n",(0,i.jsxs)(t.p,{children:["If you take a look at this ",(0,i.jsx)(t.a,{href:"https://ciscosecurity.github.io/tr-05-module-maker/",children:"module maker"})," page. You should see something similar to the below image:\n",(0,i.jsx)(t.img,{alt:"module maker",src:n(4358).A+"",width:"3454",height:"1910"})]}),"\n",(0,i.jsx)(t.p,{children:"For our example, we are making an integration with Wazuh. So we will fill in the information as below:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Title"}),": Wazuh"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Default Name"}),": Wazuh"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Logo"}),": upload the wazuh logo or any image you like"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"URL"}),": the ngrok URL we got from the previous page"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Authorization"}),": select the authorization method you want to use. For this example, we will use ",(0,i.jsx)(t.em,{children:"basic"})," here."]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["It should start to look like the below image:\n",(0,i.jsx)(t.img,{alt:"module maker partially filled in",src:n(2797).A+"",width:"3456",height:"1916"})]}),"\n",(0,i.jsxs)(t.p,{children:["Scroll down some in the area where we were filling in the module information and you should see a ",(0,i.jsx)(t.strong,{children:"Configuration Spec +Add"})," option. Click on the add button twice."]}),"\n",(0,i.jsx)(t.p,{children:"Now there should be two blank asking for a key, type, and label."}),"\n",(0,i.jsx)(t.p,{children:"We will fill each in as follows. The top box will be used as the username box within XDR when someone wants to integrate with Wazuh."}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["key = ",(0,i.jsx)(t.em,{children:"basic-auth-user"})]}),"\n",(0,i.jsxs)(t.li,{children:["type = ",(0,i.jsx)(t.em,{children:"string"})]}),"\n",(0,i.jsxs)(t.li,{children:["label = ",(0,i.jsx)(t.em,{children:"API user"})]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"The second box will be where we put the password the user needs to enter when adding the integration."}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["key = ",(0,i.jsx)(t.em,{children:"basic-auth-password"})]}),"\n",(0,i.jsxs)(t.li,{children:["type = ",(0,i.jsx)(t.em,{children:"password"})]}),"\n",(0,i.jsxs)(t.li,{children:["label = ",(0,i.jsx)(t.em,{children:"Password"})]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["Then check the box ",(0,i.jsx)(t.strong,{children:"Required"})," at the bottom of both boxes. It should look similar to what is below:\n",(0,i.jsx)(t.img,{alt:"module maker fully filled in",src:n(1454).A+"",width:"2108",height:"1918"})]}),"\n",(0,i.jsxs)(t.p,{children:["Lastly, add a description to the health capability and then we can save it. I entered ",(0,i.jsx)(t.em,{children:"health"})," as my description."]}),"\n",(0,i.jsxs)(t.p,{children:["On the left side of the page in the blue navigation bar, click on ",(0,i.jsx)(t.strong,{children:"Save JSON"}),".\n",(0,i.jsx)(t.img,{alt:"save json",src:n(8095).A+"",width:"708",height:"620"})]}),"\n",(0,i.jsxs)(t.p,{children:["That should have downloaded a ",(0,i.jsx)(t.em,{children:"Wazuh_module_type.json"})," to your computer."]}),"\n",(0,i.jsx)(t.p,{children:"Next we will upload this to our XDR instance using the IROH Module Type APIs."}),"\n",(0,i.jsx)(t.h2,{id:"upload-module-type-to-cisco-xdr",children:"Upload Module Type to Cisco XDR"}),"\n",(0,i.jsxs)(t.p,{children:["To upload our module type to Cisco XDR we need to go to the ",(0,i.jsx)(t.a,{href:"https://visibility.amp.cisco.com/iroh/iroh-int/index.html",children:"IROH Module Type API swagger"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["After the page loads, it should look like the below image:\n",(0,i.jsx)(t.img,{alt:"module maker swagger",src:n(3749).A+"",width:"3456",height:"1900"})]}),"\n",(0,i.jsxs)(t.p,{children:["Click the white button with the green outline called ",(0,i.jsx)(t.strong,{children:"Authorize"})," on the right side of the screen. It should pop up a screen asking you how to login like what is shown below:\n",(0,i.jsx)(t.img,{alt:"swagger login",src:n(2781).A+"",width:"3456",height:"1914"})]}),"\n",(0,i.jsxs)(t.p,{children:["Click on the first option ",(0,i.jsx)(t.em,{children:"Log In with Security Cloud Sign On"})," and go through the SSO process to sign into your Cisco XDR tenant."]}),"\n",(0,i.jsxs)(t.p,{children:["After the login is successful, go down to the ",(0,i.jsx)(t.strong,{children:"ModuleType"})," section and expand the ",(0,i.jsx)(t.strong,{children:"POST"})," requestion option.\n",(0,i.jsx)(t.img,{alt:"module type post",src:n(8421).A+"",width:"3456",height:"1574"})]}),"\n",(0,i.jsxs)(t.p,{children:["Click on the ",(0,i.jsx)(t.strong,{children:"Try it out"})," button and it will open up the editor for us to paste in the JSON we saved from the ",(0,i.jsx)(t.em,{children:"Module Maker"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["Copy the JSON code from the file that was downloaded and then ",(0,i.jsx)(t.em,{children:"select all"})," in the edit box of the swagger docs. Then past the JSON into the box. It should look similar to the below:"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"input module json",src:n(5621).A+"",width:"2898",height:"1380"})}),"\n",(0,i.jsxs)(t.p,{children:["Then click on the big ",(0,i.jsx)(t.strong,{children:"Execute"})," button at the bottom."]}),"\n",(0,i.jsx)(t.p,{children:"If you scroll down, you will see the curl version of the request and then farther down you should see a 201 response code and it will be the new module being added to Cisco XDR."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"module added to xdr response",src:n(6329).A+"",width:"3454",height:"1916"})}),"\n",(0,i.jsx)(t.p,{children:"Now lets check Cisco XDR to see if it is there as an option to add."}),"\n",(0,i.jsx)(t.h2,{id:"check-xdr-module",children:"Check XDR Module"}),"\n",(0,i.jsx)(t.p,{children:'Log into Cisco XDR and go to the integrations tab like we did when adding the "Generic" integration.'}),"\n",(0,i.jsxs)(t.p,{children:["Then look for the new Wazuh integration in the ",(0,i.jsx)(t.em,{children:"Third Party"})," tab.\n",(0,i.jsx)(t.img,{alt:"module added to xdr response",src:n(1295).A+"",width:"1830",height:"1246"})]}),"\n",(0,i.jsxs)(t.p,{children:["If you click on ",(0,i.jsx)(t.em,{children:"+"})," sign on the bottom right of that module it will bring you to configuration page of this integration.\n",(0,i.jsx)(t.img,{alt:"module added to xdr response",src:n(8150).A+"",width:"3456",height:"1398"})]}),"\n",(0,i.jsxs)(t.p,{children:["In here, add the Wazuh API user and password, then click on ",(0,i.jsx)(t.strong,{children:"+ Add"}),". It should say the integration is connected after a second or two.\n",(0,i.jsx)(t.img,{alt:"module added to xdr response",src:n(3136).A+"",width:"3456",height:"1004"})]}),"\n",(0,i.jsxs)(t.p,{children:["If you want to go right to updating the ",(0,i.jsx)(t.em,{children:"module type"})," definition for each feature here is a link to where we go over those updates:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"dashboard-tiles/wazuh-dashboard-tiles#module-type-updates",children:"Dashboard tiles"})}),"\n",(0,i.jsx)(t.li,{children:"Incidents"}),"\n",(0,i.jsx)(t.li,{children:"Investigate"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Next we will make it so the module can use the basic auth sent to it from Cisco XDR."})]})}function c(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},2781:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/swagger-login-0106cf2e57963b925c866182df3fc034.png"},2797:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/module-maker-filled-b66f86d8325bfde7e3cf036245a830d6.png"},3136:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/wazuh-integration-added-ac9ed382375652bea139b30f232415ce.png"},3749:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/module-maker-swagger-97bee55c241b116a23344faebd2c1eeb.png"},4358:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/module-maker-f9a3633a428c4cc983420ed6a7ba0e86.png"},5621:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/input-module-json-78df0e50e0218fa68d6d5b197ce53dea.png"},6329:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/module-added-to-xdr-266ad3f665224d42c88891660bb14c96.png"},8095:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/save-json-076e4357e9e800f4ec6545c52b3ab021.png"},8150:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/wazuh-module-info-1c2e9a7dcd101290a4cb46fcf3abc8b8.png"},8421:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/module-type-post-e45b5357ad49dfdcd9f6247ed58316f9.png"},8453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>d});var o=n(6540);const i={},s=o.createContext(i);function l(e){const t=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),o.createElement(s.Provider,{value:t},e.children)}}}]);