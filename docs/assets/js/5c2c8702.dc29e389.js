"use strict";(self.webpackChunkintegration_development_docs=self.webpackChunkintegration_development_docs||[]).push([[207],{948:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/module-type-get-c9ca7dbd2ecea022f7d8177dc9e4ac4b.png"},2291:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/patch-data-37120e197c7cce932cece10424ad617b.png"},5129:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>d,default:()=>p,frontMatter:()=>l,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"relay-module/dashboard-tiles/wazuh-dashboard-tiles","title":"Creating Dashboard Tiles (with Wazuh)","description":"Dashboard Type Examples","source":"@site/mdx-docs/relay-module/dashboard-tiles/01-wazuh-dashboard-tiles.mdx","sourceDirName":"relay-module/dashboard-tiles","slug":"/relay-module/dashboard-tiles/wazuh-dashboard-tiles","permalink":"/xdr-integration-development-docs/docs/relay-module/dashboard-tiles/wazuh-dashboard-tiles","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Creating a Dashboard (F1 Style)","permalink":"/xdr-integration-development-docs/docs/relay-module/dashboard-tiles/f1-dashboard-tiles"},"next":{"title":"Incident Feature Development","permalink":"/xdr-integration-development-docs/docs/category/incident-feature-development"}}');var r=n(4848),s=n(8453),i=n(5537),o=n(9329);const l={sidebar_position:2},d="Creating Dashboard Tiles (with Wazuh)",u={},c=[{value:"Dashboard Type Examples",id:"dashboard-type-examples",level:2},{value:"Module Type updates",id:"module-type-updates",level:2},{value:"Get a Module ID",id:"get-a-module-id",level:3},{value:"Add Dashboard Tile functionality",id:"add-dashboard-tile-functionality",level:3}];function h(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"creating-dashboard-tiles-with-wazuh",children:"Creating Dashboard Tiles (with Wazuh)"})}),"\n",(0,r.jsx)(t.h2,{id:"dashboard-type-examples",children:"Dashboard Type Examples"}),"\n",(0,r.jsxs)(i.A,{children:[(0,r.jsx)(o.A,{value:"Donut",label:"Donut",default:!0,children:(0,r.jsx)(t.p,{children:"Incident correlation integrates directly into our Data Analytics Platform\nand can only be developed by Cisco. To make this integration with us, we\nwould need your cooperation and readiness to provide technical assistance\nduring the development process. However, injecting incidents into XDR does\nnot require Cisco to develop an integration."})}),(0,r.jsx)(o.A,{value:"Line",label:"Line",children:(0,r.jsx)(t.p,{children:"Injected incidents are incidents that are added to the XDR incidents queue\nvia API. This bypasses the analytics you get get with the DAP but is a way\nto centralize incidents and create investigations from them."})}),(0,r.jsx)(o.A,{value:"Number",label:"Number",children:(0,r.jsx)(t.p,{children:"Injected incidents are incidents that are added to the XDR incidents queue\nvia API. This bypasses the a"})})]}),"\n",(0,r.jsx)(t.admonition,{type:"note",children:(0,r.jsxs)(t.p,{children:["To get more dashboard tile types, try using this link to get more examples of the dashboards and add them to your XDR instance",(0,r.jsx)(t.a,{href:"https://xdr.us.security.cisco.com/control-center?demo-tiles=1"})]})}),"\n",(0,r.jsx)(t.h2,{id:"module-type-updates",children:"Module Type updates"}),"\n",(0,r.jsx)(t.h3,{id:"get-a-module-id",children:"Get a Module ID"}),"\n",(0,r.jsxs)(t.p,{children:["Lets get the our module's ID so we can update. Find the ",(0,r.jsx)(t.strong,{children:"ModuleType"})," routes and go to the ",(0,r.jsx)(t.strong,{children:"GET"})," request route ",(0,r.jsx)(t.em,{children:"/iroh/iroh-int/module-type"}),".\n",(0,r.jsx)(t.img,{alt:"get relay",src:n(948).A+"",width:"982",height:"393"})]}),"\n",(0,r.jsxs)(t.p,{children:["Click on ",(0,r.jsx)(t.strong,{children:"Try it out"})," and then ",(0,r.jsx)(t.strong,{children:"Execute"}),". THis will get all of the modules you have in XDR. In the blob of JSON that is returned search for ",(0,r.jsx)(t.em,{children:"Wazuh"})," and search for the ",(0,r.jsx)(t.em,{children:"id"})," field in the entry for Wazuh. Save this ID so we can use it later."]}),"\n",(0,r.jsx)(t.p,{children:"Now that we have our module ID, we can update the module functionality for tiles data."}),"\n",(0,r.jsx)(t.h3,{id:"add-dashboard-tile-functionality",children:"Add Dashboard Tile functionality"}),"\n",(0,r.jsxs)(t.p,{children:["To add the tiles functionality we need to to use the below JSON to ",(0,r.jsx)(t.strong,{children:"PATCH"})," our module."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-json",children:'{\n  "properties": {\n    "supported-apis": ["health", "tiles", "tiles/tile", "tiles/tile-data"]\n  },\n  "capabilities": [\n    {\n      "id": "tiles",\n      "description": "Wazuh Tiles"\n    },\n    {\n      "id": "health",\n      "description": "health check for Wazuh module"\n    }\n  ]\n}\n'})}),"\n",(0,r.jsxs)(t.admonition,{type:"danger",children:[(0,r.jsx)(t.p,{children:"You have to append to the capabilities list and to the supported apis list for the functionality you want to add to work. If you only input the tiles endpoint it will update the module to only use the tiles endpoint. Appending the tiles to the health endpoint and then patching will allow the module to use both."}),(0,r.jsx)(t.admonition,{type:"warning",children:(0,r.jsx)(t.p,{children:"It is very important to use double quotes here or the swagger docs will not send the request."})})]}),"\n",(0,r.jsxs)(t.p,{children:["Copy the above snippet and find the ",(0,r.jsx)(t.strong,{children:"ModuleType"})," routes for ",(0,r.jsx)(t.strong,{children:"PATCH"})," ",(0,r.jsx)(t.em,{children:"/iroh/iroh-int/module-type/{id}"})]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"patch relay",src:n(8837).A+"",width:"851",height:"271"})}),"\n",(0,r.jsxs)(t.p,{children:["Click on ",(0,r.jsx)(t.strong,{children:"Try it out"}),", paste the module ID in the ",(0,r.jsx)(t.strong,{children:"id"})," field and then paste the JSON above into the ",(0,r.jsx)(t.strong,{children:"PatchModuleTypeParams"})," field."]}),"\n",(0,r.jsx)(t.p,{children:"Your update should look similar to the below:"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"patched relay",src:n(2291).A+"",width:"908",height:"672"})}),"\n",(0,r.jsx)(t.p,{children:"If you look in the response, you should see there is a section for supported APIs and capabilities. Both of these should list the various tile endpoints in them."}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"tiles api enabled",src:n(5242).A+"",width:"491",height:"454"})})]})}function p(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},5242:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/tiles-api-enabled-0b1d20f129b2fc8a56dbc48d454cebe2.png"},5537:(e,t,n)=>{n.d(t,{A:()=>w});var a=n(6540),r=n(4164),s=n(5627),i=n(6347),o=n(372),l=n(604),d=n(1861),u=n(8749);function c(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:t,children:n}=e;return(0,a.useMemo)((()=>{const e=t??function(e){return c(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:r}}=e;return{value:t,label:n,attributes:a,default:r}}))}(n);return function(e){const t=(0,d.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function p(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:n}=e;const r=(0,i.W6)(),s=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,l.aZ)(s),(0,a.useCallback)((e=>{if(!s)return;const t=new URLSearchParams(r.location.search);t.set(s,e),r.replace({...r.location,search:t.toString()})}),[s,r])]}function b(e){const{defaultValue:t,queryString:n=!1,groupId:r}=e,s=h(e),[i,l]=(0,a.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:s}))),[d,c]=m({queryString:n,groupId:r}),[b,f]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[r,s]=(0,u.Dv)(n);return[r,(0,a.useCallback)((e=>{n&&s.set(e)}),[n,s])]}({groupId:r}),g=(()=>{const e=d??b;return p({value:e,tabValues:s})?e:null})();(0,o.A)((()=>{g&&l(g)}),[g]);return{selectedValue:i,selectValue:(0,a.useCallback)((e=>{if(!p({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);l(e),c(e),f(e)}),[c,f,s]),tabValues:s}}var f=n(9136);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var y=n(4848);function x(e){let{className:t,block:n,selectedValue:a,selectValue:i,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:d}=(0,s.a_)(),u=e=>{const t=e.currentTarget,n=l.indexOf(t),r=o[n].value;r!==a&&(d(t),i(r))},c=e=>{let t=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const n=l.indexOf(e.currentTarget)+1;t=l[n]??l[0];break}case"ArrowLeft":{const n=l.indexOf(e.currentTarget)-1;t=l[n]??l[l.length-1];break}}t?.focus()};return(0,y.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":n},t),children:o.map((e=>{let{value:t,label:n,attributes:s}=e;return(0,y.jsx)("li",{role:"tab",tabIndex:a===t?0:-1,"aria-selected":a===t,ref:e=>{l.push(e)},onKeyDown:c,onClick:u,...s,className:(0,r.A)("tabs__item",g.tabItem,s?.className,{"tabs__item--active":a===t}),children:n??t},t)}))})}function v(e){let{lazy:t,children:n,selectedValue:s}=e;const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=i.find((e=>e.props.value===s));return e?(0,a.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,y.jsx)("div",{className:"margin-top--md",children:i.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==s})))})}function j(e){const t=b(e);return(0,y.jsxs)("div",{className:(0,r.A)("tabs-container",g.tabList),children:[(0,y.jsx)(x,{...t,...e}),(0,y.jsx)(v,{...t,...e})]})}function w(e){const t=(0,f.A)();return(0,y.jsx)(j,{...e,children:c(e.children)},String(t))}},8453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>o});var a=n(6540);const r={},s=a.createContext(r);function i(e){const t=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),a.createElement(s.Provider,{value:t},e.children)}},8837:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/module-patch-ceff24059c0669952a910ca0ec05a04b.png"},9329:(e,t,n)=>{n.d(t,{A:()=>i});n(6540);var a=n(4164);const r={tabItem:"tabItem_Ymn6"};var s=n(4848);function i(e){let{children:t,hidden:n,className:i}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,a.A)(r.tabItem,i),hidden:n,children:t})}}}]);